<!DOCTYPE html><html lang="en-GB" class="core o-typography--loading-sans o-typography--loading-sans-bold o-typography--loading-display o-typography--loading-display-bold" data-o-component="o-typography"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Create A New Origami Component - Part 7 Testing</title><meta name="description" content="A step-by-step tutorial which teaches you how to build and deploy a new Origami component."><!-- Cuts the mustard test --><!-- Favicons --><link rel="icon" type="image/svg+xml" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&format=svg" sizes="any"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=16&height=16&format=png" sizes="16x16"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=32&height=32&format=png" sizes="32x32"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=96&height=96&format=png" sizes="96x96"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=128&height=128&format=png" sizes="128x128"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=196&height=196&format=png" sizes="196x196"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=310&height=310&format=png" sizes="310x310"><!-- Site links --><link rel="sitemap" type="application/xml" href="/sitemap-index.xml" title="Sitemap"><link rel="canonical" href="https://origami.ft.com/documentation/tutorials/create-a-new-component-part-7/"><!-- Progressive Font Loading --><!-- https://github.com/Financial-Times/o-typography/tree/v6.1.3#setup-progressive-loading --><!-- Styles --><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="https://www.ft.com/__origami/service/build/v3/bundles/css?components=o-layout@^5.3.2,o-typography@^7.4.1,o-normalise@^3.3.1,o-header-services@^5.3.4,o-footer-services@^4.2.6,o-message@^5.4.2,o-table@^9.3.1,o-autoinit@^3.1.3,o-forms@^9.11.2,o-tracking@^4.5.0,o-colors@^6.6.2,o-spacing@^3.2.3&#38;brand=internal&#38;system_code=origami-website"><!-- JS --><script defer src="https://www.ft.com/__origami/service/build/v3/bundles/js?components=o-layout@^5.3.2,o-typography@^7.4.1,o-normalise@^3.3.1,o-header-services@^5.3.4,o-footer-services@^4.2.6,o-message@^5.4.2,o-table@^9.3.1,o-autoinit@^3.1.3,o-forms@^9.11.2,o-tracking@^4.5.0&#38;system_code=origami-website"></script><script defer src="/assets/tracking.js"></script><link rel="stylesheet" href="/_astro/404.93bfcc51.css" />
<link rel="stylesheet" href="/_astro/RacingBars.0a6fad8c.css" /><script type="module">var o=document.querySelector("html");if(/(^|\s)o-typography-fonts-loaded=1(;|$)/.test(document.cookie))for(var a=["sans","sans-bold","display","display-bold"],e=0;e<a.length;e++)o.className=o.className.replace("o-typography--loading-"+a[e],"");var t="querySelector"in document&&"localStorage"in window&&"addEventListener"in window;t&&(document.documentElement.className=document.documentElement.className.replace(/\bcore\b/g,"enhanced"));
</script></head><body><div class="o-layout o-layout--docs" data-o-component="o-layout"><div class="o-layout__header"><header class="o-header-services" data-o-component="o-header-services"><div class="o-header-services__top"><div class="o-header-services__hamburger"><a class="o-header-services__hamburger-icon" href="#" role="button"><span class="o-header-services__visually-hidden">Open primary navigation</span></a></div><a href="/" class="o-header-services__logo"><span class="o-header-services__visually-hidden">To homepage</span></a><div class="o-header-services__title"><a class="o-header-services__product-name" href="/">Origami</a><span class="o-header-services__product-tagline">Frontend Components &amp; Services</span></div></div><nav class="o-header-services__primary-nav" aria-label="primary"><ul class="o-header-services__primary-nav-list"><li><a href="/">Home</a></li><li><a href="/documentation/">Documentation</a></li><li><a href="https://registry.origami.ft.com/components">Registry</a></li><li><a href="/storybook/">Storybook</a></li><li><a href="/blog/">Blog</a></li></ul></nav><nav class="o-header-services__secondary-nav" aria-label="secondary" data-o-header-services-nav=""><div class="o-header-services__secondary-nav-content" data-o-header-services-nav-list=""><ol class="o-header-services__secondary-nav-list o-header-services__secondary-nav-list--ancestors" aria-label="Ancestor sections"><li><a href="/documentation/">Documentation</a></li><li><a href="/documentation/tutorials/">Tutorials</a></li></ol><ul class="o-header-services__secondary-nav-list o-header-services__secondary-nav-list--children" aria-label="Child sections"></ul></div><button class="o-header-services__scroll-button o-header-services__scroll-button--left" title="scroll left" aria-hidden="true" disabled></button><button class="o-header-services__scroll-button o-header-services__scroll-button--right" title="scroll right" aria-hidden="true" disabled></button></nav></header></div><div class="o-layout__sidebar"></div><div class="o-layout__main o-layout-typography"><h1 id="create-a-new-origami-component---part-7-testing">Create A New Origami Component - Part 7 Testing</h1>
<p>The “Create A New Origami Component” tutorial is split into nine parts and is intended to be followed sequentially from start to finish:</p>
<ol>
<li><a href="/documentation/tutorials/create-a-new-component-part-1/">Intro &#x26; Boilerplate</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-2/">Base Styles</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-3/">Themes &#x26; Brands</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-4/">Demos</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-5/">JavaScript</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-6/">Storybook</a></li>
<li>Testing</li>
<li><a href="/documentation/tutorials/create-a-new-component-part-8/">Documentation</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-9/">Component Lifecycle</a></li>
</ol>
<p>In part seven we will add tests to our component. Including tests for Sass, JavaScript, and common accessibility issues.</p>
<p>Run <code>npm run test -w components/o-example</code> to run component tests (you will get some errors but we will fix it in a moment). Run <code>npm run lint -w components/o-example</code> to lint code style and check the validity of <code>origami.json</code>.</p>
<h2 id="sass-tests">Sass Tests</h2>
<p>Component Sass tests are run using the <a href="https://www.oddbird.net/true/">Oddbird True</a> library. Sass tests for a component are located in the <code>test/scss</code> directory.</p>
<p>This tutorial won’t cover Oddbird True in detail, for that see the <a href="https://www.oddbird.net/true/docs/">Oddbird True documentation</a>. However to demonstrate we will update the boilerplate test (<code>tests/scss/_main.test.scss</code>) to confirm the <code>oExample</code> mixin outputs CSS for the inverse theme by default:</p>
<pre><code class="o-syntax-highlight--scss">// tests/scss/_main.test.scss

@include describe('oExample mixins') {
    // tests for the primary mixin oExample
	@include describe('oExample') {
		@include it('outputs the inverse theme by default') {
			@include assert() {
				// output actual CSS
				@include output() {
					@include oExample();
				}
				// expected output CSS to contain
				@include contains() {
					.o-example--inverse {
						background: #262a33;
						color: #ffffff;
					}
				}
			}
		}
	}
}</code></pre>
<p>Again running the <code>npm run test -w components/o-example</code> command should show our new tests have run and passed.</p>
<h2 id="javascript-tests">JavaScript Tests</h2>
<p>Component JavaScript tests use <a href="https://mochajs.org/">mocha</a> as a test runner; <a href="https://sinonjs.org/">sinon</a> for stubs, spies, and mocks; and <a href="https://github.com/rowanmanning/proclaim">proclaim</a> to make assertions.</p>
<p>To demonstrate how these projects are used to test components we will add a new test to confirm that clicking a button in our component increments the count.</p>
<p>JavaScript tests are located under the <code>test</code> directory. The file <code>example.test.js</code> already has boilerplate tests, which use component markup defined in <code>tests/js/helpers/fixtures.js</code> to confirm the <code>init</code> method works as expected.</p>
<p>Our first step will be to update the <code>htmlCode</code> method in <code>tests/js/helpers/fixtures.js</code> with our latest component markup. We’ll add an id <code>id="element"</code> which we can use in our tests:</p>
<pre><code class="o-syntax-highlight--js">// tests/js/helpers/fixtures.js

function htmlCode () {
	const html = `
        &#x3C;div id="element" class="o-example" data-o-component="o-example">
            Hello world, I am a component named o-example!
            &#x3C;span class="o-example__counter">
                You have clicked this lovely button &#x3C;span data-o-example-current-count>0&#x3C;/span> times.
                &#x3C;button class="o-example__button">count&#x3C;/button>
            &#x3C;span>
        &#x3C;/div>
	`;
	insert(html);
}
</code></pre>
<p>Next we can append our new tests within the main <code>describe("Example", () => {})</code> block:</p>
<pre><code class="o-syntax-highlight--js">// tests/js/example.test.js

describe("with a button", () => {

    beforeEach(() => {
        // Add our component markup to the DOM
        fixtures.htmlCode();
    });

    afterEach(() => {
        // Remove our component markup from the DOM
        fixtures.reset();
    });

    it("should increment the count on click", () => {
        // initialise o-example on fixture markup
        const oExample = Example.init('#element');
        // find and click the button
        const button = document.querySelector('button');
        button.click();
        // confirm the count has incremented
        const actual = oExample.count;
        const expected = 1;
        proclaim.equal(actual, expected, `Expected count to equal ${expected} given a single button click.`);
    });
});
</code></pre>
<p>Now run <code>npm run test -w components/o-example</code>. You should see our new tests are run and pass.</p>
<h2 id="accessibility-tests">Accessibility Tests</h2>
<p><code>npm run test -w components/o-example</code> also runs some accessibility checks. Whilst this will catch some common causes of accessibility issues, such as invalid html or low contrast between text and background, it is not a comprehensive test of component accessibility. For help testing the accessibility of your component see the <a href="/documentation/principles/accessibility/">Origami’s accessibility principles</a> page, or reach out to the Financial Times <a href="https://app.slack.com/client/T025C95MN/C2LMEKC6S">#accessibility Slack channel</a>.</p>
<h2 id="visual-regression-tests">Visual Regression Tests</h2>
<p>To check all component demos for any visual bugs that may have been introduced accidentally as part of a change may be rather taxing as a manual piece of work. To help, demos may be run through <a href="https://percy.io/">percy.io</a> to highlight visual differences between two versions of a component automatically.</p>
<p>We can’t run Percy yet as we haven’t released a version of our component to compare changes against. But later, when we have released our component, <a href="https://percy.io/">percy.io</a> will run automatically against new pull requests.</p>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-21-tests.png">
	<figcaption>
				Percy checks are run automatically and this image shows a Github pull request where the `percy` has already ran to visually compare `o-autocomplete` demos in the pull request against the last release.
	</figcaption>
</figure>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-22-tests.png">
	<figcaption>
        This image shows an example of the Percy interface. To the left is an image of a component demo, to the right the updated demo with visual changes highlighted in red.
	</figcaption>
</figure>
<h2 id="part-seven-documentation">Part Seven: Documentation</h2>
<p>Our component is working well and is almost complete. In this tutorial we learned:</p>
<ul>
<li>That <code>npm run test -w components/o-example</code> runs Sass, JavaScript, and limited accessibility tests.</li>
<li>That <code>npm run lint -w components/o-example</code> analyses our component for potential errors.</li>
<li>How to write Sass tests for the <code>npm run test -w components/o-example</code> command.</li>
<li>How to write and run JavaScript tests for the <code>npm run test -w components/o-example</code> command.</li>
<li>How to highlight visual differences a change has introduced with <a href="https://percy.io/">percy.io</a>.</li>
</ul>
<p>So far we have missed a crucial part of creating a component: documentation. Without documentation our component will be difficult for users to include in projects and future development may be hindered. In part eight we’ll document our component in a way that is familiar to users and maintainers of other Origami components. <a href="/documentation/tutorials/create-a-new-component-part-8">Continue to part eight</a>.</p></div><div class="o-layout__footer"><footer class="o-footer-services"><div class="o-footer-services__container"><div class="o-footer-services__wrapper o-footer-services__wrapper--top"><a class="o-footer-services__icon-link o-footer-services__icon-link--github" href="https://github.com/Financial-Times/origami">View project on GitHub</a><a class="o-footer-services__icon-link o-footer-services__icon-link--github" href="https://github.com/Financial-Times/origami/pulls?q=is%3Apr+is%3Aopen+sort%3Aupdated-desc">View proposals to Origami</a><a class="o-footer-services__icon-link o-footer-services__icon-link--slack" href="https://financialtimes.slack.com/messages/origami-support">#origami-support</a><p class="o-footer-services__content">
Get in touch at <a href="mailto:origami.support@ft.com">origami.support@ft.com</a> for help or advice.
				Feel free to
<a href="https://github.com/Financial-Times/origami/edit/main/apps/website/src/pages/documentation/tutorials/create-a-new-component-part-7/">suggest an edit to this page</a>.
</p></div></div><div class="o-footer-services__container"><div class="o-footer-services__wrapper o-footer-services__wrapper--legal"><div class="o-footer-services__links"><a href="https://help.ft.com/help/legal-privacy/cookies/">Cookies</a><a href="https://help.ft.com/help/legal-privacy/copyright/copyright-policy/">Copyright</a><a href="https://help.ft.com/help/legal-privacy/privacy/">Privacy</a><a href="https://help.ft.com/help/legal-privacy/terms-conditions">Terms & Conditions</a><a href="https://help.ft.com/legal-privacy/copyright-policy/">Slavery Statement & Policies</a></div><p><span>&copy; THE FINANCIAL TIMES LTD 2024.</span> FT and
				'Financial Times' are trademarks of The Financial Times Ltd.
</p></div></div></footer></div></div></body></html>