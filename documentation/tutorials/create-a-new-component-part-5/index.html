<!DOCTYPE html><html lang="en-GB" class="core o-typography--loading-sans o-typography--loading-sans-bold o-typography--loading-display o-typography--loading-display-bold" data-o-component="o-typography"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Create A New Origami Component - Part 5 JavaScript</title><meta name="description" content="A step-by-step tutorial which teaches you how to build and deploy a new Origami component."><!-- Cuts the mustard test --><!-- Favicons --><link rel="icon" type="image/svg+xml" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&format=svg" sizes="any"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=16&height=16&format=png" sizes="16x16"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=32&height=32&format=png" sizes="32x32"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=96&height=96&format=png" sizes="96x96"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=128&height=128&format=png" sizes="128x128"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=196&height=196&format=png" sizes="196x196"><link rel="alternate icon" type="image/png" href="https://www.ft.com/__origami/service/image/v2/images/raw/ftlogo-v1%3Aorigami?source=origami-docs&width=310&height=310&format=png" sizes="310x310"><!-- Site links --><link rel="sitemap" type="application/xml" href="/sitemap-index.xml" title="Sitemap"><link rel="canonical" href="https://origami.ft.com/documentation/tutorials/create-a-new-component-part-5/"><!-- Progressive Font Loading --><!-- https://github.com/Financial-Times/o-typography/tree/v6.1.3#setup-progressive-loading --><!-- Styles --><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="https://www.ft.com/__origami/service/build/v3/bundles/css?components=o-syntax-highlight@^4.2.4,o-layout@^5.3.2,o-typography@^7.4.1,o-normalise@^3.3.1,o-header-services@^5.3.4,o-footer-services@^4.2.6,o-message@^5.4.2,o-table@^9.3.1,o-autoinit@^3.1.3,o-forms@^9.11.2,o-colors@^6.6.2,o-spacing@^3.2.3&#38;brand=internal&#38;system_code=origami-website"><!-- JS --><script defer src="https://www.ft.com/__origami/service/build/v3/bundles/js?components=o-syntax-highlight@^4.2.4,o-layout@^5.3.2,o-typography@^7.4.1,o-normalise@^3.3.1,o-header-services@^5.3.4,o-footer-services@^4.2.6,o-message@^5.4.2,o-table@^9.3.1,o-autoinit@^3.1.3,o-forms@^9.11.2&#38;system_code=origami-website"></script><link rel="stylesheet" href="/_astro/404.f4c6582d.css" />
<link rel="stylesheet" href="/_astro/RacingBars.0a6fad8c.css" /><script type="module">var o=document.querySelector("html");if(/(^|\s)o-typography-fonts-loaded=1(;|$)/.test(document.cookie))for(var a=["sans","sans-bold","display","display-bold"],e=0;e<a.length;e++)o.className=o.className.replace("o-typography--loading-"+a[e],"");var t="querySelector"in document&&"localStorage"in window&&"addEventListener"in window;t&&(document.documentElement.className=document.documentElement.className.replace(/\bcore\b/g,"enhanced"));
</script></head><body><div class="o-layout o-layout--docs" data-o-component="o-layout"><div class="o-layout__header"><header class="o-header-services" data-o-component="o-header-services"><div class="o-header-services__top"><div class="o-header-services__hamburger"><a class="o-header-services__hamburger-icon" href="#" role="button"><span class="o-header-services__visually-hidden">Open primary navigation</span></a></div><a href="/" class="o-header-services__logo"><span class="o-header-services__visually-hidden">To homepage</span></a><div class="o-header-services__title"><a class="o-header-services__product-name" href="/">Origami</a><span class="o-header-services__product-tagline">Frontend Components &amp; Services</span></div></div><nav class="o-header-services__primary-nav" aria-label="primary"><ul class="o-header-services__primary-nav-list"><li><a href="/">Home</a></li><li><a href="/documentation/">Documentation</a></li><li><a href="https://registry.origami.ft.com/components">Registry</a></li><li><a href="/storybook/">Storybook</a></li><li><a href="/blog/">Blog</a></li></ul></nav><nav class="o-header-services__secondary-nav" aria-label="secondary" data-o-header-services-nav=""><div class="o-header-services__secondary-nav-content" data-o-header-services-nav-list=""><ol class="o-header-services__secondary-nav-list o-header-services__secondary-nav-list--ancestors" aria-label="Ancestor sections"><li><a href="/documentation/">Documentation</a></li><li><a href="/documentation/tutorials/">Tutorials</a></li></ol><ul class="o-header-services__secondary-nav-list o-header-services__secondary-nav-list--children" aria-label="Child sections"></ul></div><button class="o-header-services__scroll-button o-header-services__scroll-button--left" title="scroll left" aria-hidden="true" disabled></button><button class="o-header-services__scroll-button o-header-services__scroll-button--right" title="scroll right" aria-hidden="true" disabled></button></nav></header></div><div class="o-layout__sidebar"></div><div class="o-layout__main o-layout-typography" data-o-component="o-syntax-highlight"><h1 id="create-a-new-origami-component---part-5-javascript">Create A New Origami Component - Part 5 JavaScript</h1>
<p>The “Create A New Origami Component” tutorial is split into nine parts and is intended to be followed sequentially from start to finish:</p>
<ol>
<li><a href="/documentation/tutorials/create-a-new-component-part-1/">Intro &#x26; Boilerplate</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-2/">Base Styles</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-3/">Themes &#x26; Brands</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-4/">Demos</a></li>
<li>JavaScript</li>
<li><a href="/documentation/tutorials/create-a-new-component-part-6/">Storybook</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-7/">Testing</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-8/">Documentation</a></li>
<li><a href="/documentation/tutorials/create-a-new-component-part-9/">Component Lifecycle</a></li>
</ol>
<p>In part five we will add interactivity to our component using JavaScript. For reference, there is a <a href="/specification/v1/components/javascript/">JavaScript part of the component specification</a> which we will be conforming to.</p>
<p>We’ll increment a counter within the component which will update every time the button is clicked. The counter will have an option to display a customisable message after a given count e.g. after 10 clicks display the word “lots” instead.</p>
<h2 id="initialising-component-javascript">Initialising Component JavaScript</h2>
<p>Our boilerplate JavaScript <code>main.js</code> and <code>/src/js/example</code> has all we need to <a href="/specification/v1/components/javascript/#initialisation">run (initialise) the component JavaScript</a> and get any options we may want to allow users to configure.</p>
<p>All Origami components provide <a href="/specification/v1/components/javascript/#initialisation">an <code>init</code> method</a> for running component JavaScript. Notice the JavaScript class for our component and its <code>init</code> method is defined in <code>/src/js/example</code> (where <code>example</code> is the component name without the <code>o-</code> prefix).</p>
<p>By default the <code>init</code> method will initialise any elements on the page which have the <code>data-o-component="o-example"</code> attribute. If a <code>HTMLElement</code> object or valid <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Locating_DOM_elements_using_selectors"><code>querySelector</code> expression</a> is given the <code>init</code> method will initialise the element given, or any children, with the <code>data-o-component="o-example"</code> attribute.</p>
<p><code>main.js</code> has some standard code to automatically run the component’s <code>init</code> method when the <code>o.DOMContentLoaded</code> Origami event is fired (see <a href="https://registry.origami.ft.com/components/o-autoinit@2.0.4/readme">o-autoinit</a>). It also exports the component so users may alternatively import <code>main.js</code> and directly run <code>init</code> with relevant options for themselves.</p>
<p>For example a user could initialise all <code>o-example</code> elements on the page by including <code>o-autoinit</code>, which will fire the <code>o.DOMContentLoaded</code> event when the page is ready:</p>
<pre><code class="o-syntax-highlight--js">// Initialise all elements on the page which have the
// `data-o-component="o-example"` attribute when
// `o-autoinit` fires the `o.DOMContentLoaded` event.
import 'o-autoinit';
import 'o-example';</code></pre>
<p>Or by calling the <code>init</code> method with no arguments:</p>
<pre><code class="o-syntax-highlight--js">// Initialise all elements on the page which have the
// `data-o-component="o-example"` attribute.
import oExample from 'o-example';
oExample.init();</code></pre>
<p>Or a user could initialise a specific element, or its child elements, by calling the <code>init</code> method with an argument</p>
<pre><code class="o-syntax-highlight--js">// Initialise the `.my-selector` element or any of its children
// which have the `data-o-component="o-example"` attribute.
import oExample from 'o-example';
const myElement = document.querySelector('.my-selector');
oExample.init(myElement);</code></pre>
<pre><code class="o-syntax-highlight--js">// Initialise the `.my-selector` element or any of its children
// which have the `data-o-component="o-example"` attribute.
import oExample from 'o-example';
oExample.init('.my-selector');</code></pre>
<p>For more details see the <a href="/specification/v1/components/javascript/#initialisation">JavaScript initialisation</a> section of the Origami specification.</p>
<h2 id="user-configuration">User Configuration</h2>
<p>The second <code>init</code> argument is <code>options</code>, an <code>Object</code> of options for the user to configure the component. So users of <a href="https://registry.origami.ft.com/components/o-autoinit@2.0.4/readme">o-autoinit</a> or the <a href="https://www.ft.com/__origami/service/build/v3/">Origami Build Service</a> can also configure components, data attributes may alternatively be used to set component configuration.</p>
<p>In <code>/src/js/example</code> setting component configuration is handled in the constructor. The <code>this.options</code> property is assigned to the given <code>options</code> object, which is merged with any data attributes that have a namespace <code>data-o-example-[option]</code>.</p>
<p>For instance the <code>o-table</code> component has a sort feature which may be disabled by either passing <code>{sortable: false}</code> to the <a href="https://registry.origami.ft.com/components/o-table@8.0.11/jsdoc?brand=core"><code>o-table</code> <code>init</code> method</a> or by adding the <a href="https://registry.origami.ft.com/components/o-table@8.0.11/readme?brand=core#disable-sort"><code>data-o-table-sortable="false"</code></a> attribute to the <code>o-table</code> element.</p>
<p>We’ll add configuration options later to demonstrate. For full details see the <a href="/specification/v1/components/javascript/#configuration">JavaScript configuration</a> section of the Origami specification.</p>
<h2 id="interactivity">Interactivity</h2>
<p>Lets start work on making our example component interactive.</p>
<p>We’ll start by adding a <code>count</code> property, and listen for clicks on <code>o-example</code> buttons using the <a href="https://medium.com/@WebReflection/dom-handleevent-a-cross-platform-standard-since-year-2000-5bf17287fd38"><code>handleEvent</code></a> method to increment the count property.</p>
<p>Origami components use browser apis directly for <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model"><abbr title="Document Object Model">DOM</abbr></a> manipulation. For instance <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector"><code>Document.querySelector</code></a> to get an element and <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/innerText"><code>HTMLElement.innerText</code></a> to set an elements text content.</p>
<pre><code class="o-syntax-highlight--js">// src/js/example.js

	/**
	 * Class constructor.
	 * @param {HTMLElement} [exampleEl] - The component element in the DOM
	 * @param {Object} [options={}] - An options object for configuring the component
	 */
	constructor (exampleEl, options) {
		this.exampleEl = exampleEl;
		this.options = Object.assign({}, {
		}, options || Example.getDataAttributes(exampleEl));
		// A property to store the current count.
		this.count = 0;
		// Listen to all click events on the o-example instance.
		this.exampleEl.addEventListener('click', this);
	}

	/**
	 * A method to handle event listeners.
	 * https://medium.com/@WebReflection/dom-handleevent-a-cross-platform-standard-since-year-2000-5bf17287fd38
	 * https://dom.spec.whatwg.org/#dom-eventlistener-handleevent
	 * @param {Event} event - The browser event which was triggered.
	 * @returns {void}
	 */
	handleEvent(event) {
		// When any button within the `o-example` component is clicked
		// increment the count.
		if (event.target.tagName === 'BUTTON') {
			this.count++;
			// Log the count temporarily so we can see this working.
			console.log(this.count);
		}
	}</code></pre>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-12-js.png">
	<figcaption>
        The `o-example` component with the browsers developer tools open. The numbers 1 to 5 have been logged as the button has been clicked five times.
	</figcaption>
</figure>
<p>Next we want to update our component to display the current count instead of logging the count to the browsers developer console. One way we could do that is my adding a <code>&#x3C;span></code> element to contain the current count and update its text content when the button is clicked. We’ll identify the current count span with a namespaced data attribute <code>data-o-example-current-count</code>.</p>
<pre><code class="o-syntax-highlight--diff">&#x3C;!-- demos/src/demo.mustache -->

&#x3C;div class="o-example {{#theme}}o-example--{{theme}}{{/theme}}" data-o-component="o-example">
-    Hello world, I am a component named o-example!
+    Hello world, I am a component named o-example! You have clicked this lovely button &#x3C;span data-o-example-current-count>0&#x3C;/span> times.
    &#x3C;button class="o-example__button">count&#x3C;/button>
&#x3C;/div>
</code></pre>
<p>Now in our JavaScript we can get any current count element and update it when our click count is incremented.</p>
<pre><code class="o-syntax-highlight--js">// src/js/example.js

handleEvent(event) {
    // When any button within the `o-example` component is clicked
    // increment the count.
    if (event.target.tagName === 'BUTTON') {
        this.count++;
        // Get all the elements within o-example with
        // the attribute data-o-example-current-count.
        const countElements = this.exampleEl.querySelectorAll('[data-o-example-current-count]');
        // For each count element found, update the count.
			for (const element of countElements) {
				element.innerText = this.count;
			}
    }
}</code></pre>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-13-js.png">
	<figcaption>
        The `o-example` component now displays how many times the button has been clicked. Here it has been clicked over 10 times.
	</figcaption>
</figure>
<p>Our example component now displays the click count. In the example above the button has been clicked over 10 times (what fun!) Instead of counting clicks infinitely, we should update the count to display a message “lots and lots of” after a user defined number of clicks.</p>
<p>To do that add an option <code>highCount</code> in the constructor, with a default value of <code>10</code>:</p>
<pre><code class="o-syntax-highlight--js">// src/js/example.js

constructor (exampleEl, options) {
        this.exampleEl = exampleEl;
        // Get the `highCount` option from the `options` argument or
        // from a `data-o-example-high-count` data attribute, or
        // default to `10` if not set.
		this.options = Object.assign({}, {
            highCount: 10
		}, options || Example.getDataAttributes(exampleEl));
		// A property to store the current count.
		this.count = 0;
		// Listen to all click events on the o-example instance.
		this.exampleEl.addEventListener('click', this);
	}</code></pre>
<p>And in the event handler update the counter element with the text “lots and lots of” after the button has been clicked the high count or more:</p>
<pre><code class="o-syntax-highlight--js">// src/js/example.js

handleEvent(event) {
    // When any button within the `o-example` component is clicked
    // increment the count.
    if (event.target.tagName === 'BUTTON') {
        this.count++;
        // Get all the elements within o-example with
        // the attribute data-o-example-current-count.
        const countElements = this.exampleEl.querySelectorAll('[data-o-example-current-count]');
        // For each count element found, update the count.
        // If the count is equal to or above the high count display a message instead.
        const countText = this.count &#x3C; this.options.highCount ?
            this.count :
            'lots and lots of';
        countElements.forEach(e => e.innerText = countText);
    }
}</code></pre>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-14-js.png">
	<figcaption>
        The `o-example` component now says it has been clicked "lots and lots of time" if the click count is 10 or greater.
	</figcaption>
</figure>
<h2 id="browser-support">Browser Support</h2>
<h3 id="core-experience">Core Experience</h3>
<p>Most projects which use Origami components serve a reduced “core” experience to older browsers, per the <a href="https://docs.google.com/document/d/1z6kecy_o9qHYIznTmqQ-IJqre72jhfd0nVa4JMsS7Q4/">Financial Times browser support policy</a>. The core experience at a minimum supports key and fundamental features without JavaScript. Origami components need to maintain these standards as a minimum.</p>
<p>A good component to demonstrate this is <a href="https://registry.origami.ft.com/components/o-table@8.0.11">o-table</a>. With JavaScript available <code>o-table</code> has client-side sortable columns. When JavaScript is unavailable client side sorting is not possible, and sort buttons are not displayed in table headings. Users without JavaScript have fewer features available but are not left with confusing sort buttons which do nothing, a kind of <a href="https://developer.mozilla.org/en-US/docs/Glossary/Graceful_degradation">graceful degradation</a>. <code>o-table</code> also has a responsive variant which allows the table to scroll horizontally on small devices. The scrolling table works for core experience users but is enhanced with JavaScript to include arrows for a more clear indication of when scrolling is possible, a kind of <a href="https://developer.mozilla.org/en-US/docs/Glossary/Progressive_Enhancement">progressive enhancement</a>.</p>
<p>At present our component displays a useless button for core experience users and when JavaScript <a href="https://gds.blog.gov.uk/2013/10/21/how-many-people-are-missing-out-on-javascript-enhancement/">fails for some other reason</a>. We can update our <code>o-example</code> component to hide the count button for core experience users and only display the message we have written.</p>
<p>So we know when our component JavaScript is initiated successfully lets add a data attribute <code>data-o-example-js</code> to our component as part of the constructor:</p>
<pre><code class="o-syntax-highlight--diff">// src/js/example.js

constructor (exampleEl, options) {
		this.exampleEl = exampleEl;
		this.options = Object.assign({}, {
		}, options || Example.getDataAttributes(exampleEl));
		// A property to store the current count.
		this.count = 0;
		// Listen to all click events on the o-example instance.
		this.exampleEl.addEventListener('click', this);
+		// Set a data attribute so we know the component is initiated successfully.
+		// The attribute may be used in CSS to style our component conditionally.
+		this.exampleEl.setAttribute('data-o-example-js', '');
	}</code></pre>
<p>Next lets wrap any counter specific part of <code>o-example</code> markup in a <code>span</code> element with the class <code>o-example__counter</code>:</p>
<pre><code class="o-syntax-highlight--html">&#x3C;!-- demos/src/demo.mustache  -->

&#x3C;div id="element" class="o-example {{#theme}}o-example--{{theme}}{{/theme}}" data-o-component="o-example">
	Hello world, I am a component named o-example!
	&#x3C;span class="o-example__counter">
		You have clicked this lovely button &#x3C;span data-o-example-current-count>0&#x3C;/span> times.
		&#x3C;button class="o-example__button">count&#x3C;/button>
	&#x3C;/span>
&#x3C;/div>

</code></pre>
<p>We can then then add CSS to <code>main.scss</code> to hide the counter element <code>o-example__counter</code> until the data attribute <code>data-o-example-js</code> has been added:</p>
<pre><code class="o-syntax-highlight--diff">// main.scss

@mixin oExample ($opts: (
	'themes': ('inverse', 'b2c')
)) {
	// Get the themes to output from the `$opts` argument.
	// If the user has passed an `$opts` map without a
	// `themes` key, default to an empty list.
	$themes: map-get($opts, 'themes');
	$themes: if($themes, $themes, ());

	.o-example {
		@include oTypographyBody();
		border: 1px solid _oExampleGet('border-color');
		background: _oExampleGet('background-color');
		padding: oSpacingByName('s4');
		margin: oSpacingByName('s1');
	}

+	.o-example__counter {
+		display: none;
+	}
+
+	.o-example[data-o-example-js] .o-example__counter {
+		// Show the counter content when the javascript is initiated
+		// and the data attribute is added to the parent element
+		display: inline;
+	}

	.o-example__button {
		@include oButtonsContent($opts: ('type': 'primary'));
	}

	// Call the `oExampleAddTheme` mixin to output css
	// for each theme if the current brand supports it.
	@each $name in $themes {
		@if _oExampleSupports($name) {
			@include oExampleAddTheme($name);
		}
	}
}</code></pre>
<figure>
	<img alt="" src="/assets/images/tutorial-new-component/hello-world-demo-15-js.png">
	<figcaption>
        With JavaScript unavailable our component falls back to its "Hello World" without the count feature.
	</figcaption>
</figure>
<h2 id="part-six-storybook">Part Six: Storybook</h2>
<p>In part five we learnt how to make our component interactive with JavaScript, covering:</p>
<ul>
<li>JavaScript initialisation using the <code>init</code> method.</li>
<li>JavaScript configuration using the <code>init</code> argument or namespaced data attributes.</li>
<li>How to update the <abbr title="Document Object Model">DOM</abbr> with component JavaScript.</li>
<li>How to handle no JavaScript at all, to meet Financial Times browser support requirements.</li>
</ul>
<p>In part six we’ll look at writing storybook templates for our component. <a href="/documentation/tutorials/create-a-new-component-part-6">Continue to part six</a>.</p></div><div class="o-layout__footer"><footer class="o-footer-services"><div class="o-footer-services__container"><div class="o-footer-services__wrapper o-footer-services__wrapper--top"><a class="o-footer-services__icon-link o-footer-services__icon-link--github" href="https://github.com/Financial-Times/origami">View project on GitHub</a><a class="o-footer-services__icon-link o-footer-services__icon-link--github" href="https://github.com/Financial-Times/origami/pulls?q=is%3Apr+is%3Aopen+sort%3Aupdated-desc">View proposals to Origami</a><a class="o-footer-services__icon-link o-footer-services__icon-link--slack" href="https://financialtimes.slack.com/messages/origami-support">#origami-support</a><p class="o-footer-services__content">
Get in touch at <a href="mailto:origami.support@ft.com">origami.support@ft.com</a> for help or advice.
				Feel free to
<a href="https://github.com/Financial-Times/origami/edit/main/apps/website/src/pages/documentation/tutorials/create-a-new-component-part-5/">suggest an edit to this page</a>.
</p></div></div><div class="o-footer-services__container"><div class="o-footer-services__wrapper o-footer-services__wrapper--legal"><div class="o-footer-services__links"><a href="https://help.ft.com/help/legal-privacy/cookies/">Cookies</a><a href="https://help.ft.com/help/legal-privacy/copyright/copyright-policy/">Copyright</a><a href="https://help.ft.com/help/legal-privacy/privacy/">Privacy</a><a href="https://help.ft.com/help/legal-privacy/terms-conditions">Terms & Conditions</a><a href="https://help.ft.com/legal-privacy/copyright-policy/">Slavery Statement & Policies</a></div><p><span>&copy; THE FINANCIAL TIMES LTD 2024.</span> FT and
				'Financial Times' are trademarks of The Financial Times Ltd.
</p></div></div></footer></div></div></body></html>