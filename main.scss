@import '@financial-times/o-brand/main';
@import '@financial-times/o-colors/main';
@import '@financial-times/o-grid/main';
@import '@financial-times/o-normalise/main';
@import '@financial-times/o-spacing/main';
@import '@financial-times/o-typography/main';

@import 'src/scss/variables';
@import 'src/scss/color-use-cases';
@import 'src/scss/brand';
@import 'src/scss/mixins';

/// Output all o-share styles.
///
/// @access public
/// @param {Map} $opts [('icons': ('twitter', 'facebook', 'linkedin', 'link', 'share', 'mail', 'pinterest', 'whatsapp', 'corporate'), 'sizes': ('small'), 'vertical': true, 'inverse': true)] The o-share variants to include styles for (see the README for more details).
/// @example Output all styles.
///		@include oShare();
///
/// @example Output styles for select variants.
///		@include oShare($opts: (
///       'icons': ('twitter', 'facebook', 'linkedin', 'link', 'share', 'mail', 'pinterest', 'whatsapp', 'corporate'),
///       'sizes': ('small'),
///       'vertical': true,
///       'inverse': true
///   ));
@mixin oShare($opts: (
	'icons': $_o-share-icons,
	'sizes': ('small'),
	'vertical': true,
	'inverse': true
)) {
	$vertical-enabled: map-get($opts, 'vertical');
	$inverse-enabled: map-get($opts, 'inverse');
	// Default to an empty list if no icons are given.
	$icons: map-get($opts, 'icons');
	$icons: if($icons, $icons, ());
	// Default to an empty list if no sizes are given.
	$sizes: map-get($opts, 'sizes');
	$sizes: if($sizes, $sizes, ());

	// Error if the global $system-code variable is not set.
	@if (global-variable-exists('system-code') == false or type-of($system-code) != 'string') {
		@error 'A global "$system-code" Sass variable must be set to a valid Bizops system code (\e]8;;https://biz-ops.in.ft.com/list/Systems\e\\https://biz-ops.in.ft.com/list/Systems\e]8;;\e\\).';
	}

	.o-share {
		// Include styles for the default theme.
		@include _oShareTheme($icons: $icons);
		// Include styles for the default size.
		@include _oShareSize($vertical: $vertical-enabled);
		display: inline-block;

		ul {
			margin: 0;
			padding: 0;
		}
	}

	.o-share__action {
		box-sizing: border-box;
		float: left;
		list-style-type: none;
		cursor: pointer;
		line-height: 1;
	}

	.o-share__icon {
		display: flex; // flex ignores whitespace
		align-items: center;
		position: relative;
		cursor: pointer;
		padding: 0;
		background-color: transparent;
		background-repeat: no-repeat;
		border: $o-share-border-size $o-share-border-style oColorsByUsecase('o-share/default-icon', 'border');
		// undo browser default anchor tag styles
		color: oColorsByUsecase('o-share/default-icon', 'text');
		text-decoration: none;
		// add z-index on hover or focus so the border of the icon is
		// always displayed over the border of the next icon
		&:hover,
		&:focus {
			z-index: 1;
		}

		// Used for the icon background
		&:before {
			content: '';
			display: inline-block;
			background-repeat: no-repeat;
			background-position: center;
		}

		// Used as an overlay to increase the hit target for accessibility
		&:after {
			position: absolute;
			display: block;
			content: '';
		}
	}

	.o-share__text {
		@include oTypographySans($scale: -1);
		text-align: center;
	}

	// Icon text is visually hidden by default without the class
	// `.o-share__action--labelled`.
	.o-share__action:not(.o-share__action--labelled) .o-share__text {
		@include oNormaliseVisuallyHidden();
	}


	@if index($sizes, 'small') != null {
		.o-share--small {
			@include _oShareSize('small', $vertical-enabled);
		}
	}

	@if $inverse-enabled {
		.o-share--inverse {
			@include _oShareTheme('inverse', $icons);
		}
	}

	@if $vertical-enabled {
		.o-share--vertical {
			.o-share__action {
				float: none;
			}

			.o-share__icon {
				flex-direction: column;
			}
			.o-share__text {
				// Horizontal space is tight for vertical share labels.
				@include oTypographySans($scale: -2, $include-font-family: false);
				word-wrap: anywhere;
				overflow-wrap: anywhere;
			}
		}
	}
}

@if (not $o-share-is-silent) {
	@include oShare();
	// Set to silent again to avoid being output twice
	$o-share-is-silent: true !global;
}
