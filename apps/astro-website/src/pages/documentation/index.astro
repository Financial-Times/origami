---
import Layout from "@/layouts/Layout.astro"
import {getCollection} from "astro:content"

const title = "Origami Documentation"
const description =
	"Documentation on how to use Origami's components and services to help your team deliver products for the FT."

const allPrinciples = await getCollection("documents", ({id}) =>
	id.startsWith("principles/")
)

const componentDocuments = await Astro.glob(
	"@/pages/documentation/components/*.md"
)
const sortedComponentDocuments = componentDocuments.sort((a, b) => {
	if (a.frontmatter.nav_order < b.frontmatter.nav_order) {
		return -1
	}
	if (a.frontmatter.nav_order > b.frontmatter.nav_order) {
		return 1
	}
	return 0
})

const allServices = await getCollection("documents", ({id}) =>
	id.startsWith("services/")
)
const tutorialDocuments = await Astro.glob(
	"@/pages/documentation/tutorials/**/*.md"
)
---

<Layout>
	<div class="o-layout__hero o-layout__hero--muted o-layout-typography">
		<h1>{title}</h1>
		<p>
			Documentation on how to use Origami's components and services to help your
			team deliver products for the FT.
		</p>
	</div>
	<div class="o-layout__main o-layout-typography">
		<div class="o-layout__overview">
			<div class="o-layout-item">
				<h2>Principles</h2>
				<p>
					These are the <a href="/documentation/principles/"
						>principles that the Origami team follows</a
					>
					when developing components and services:
				</p>
				<ul>
					{
						allPrinciples.map(principle => (
							<li>
								<a href={`/documentation/${principle.slug}`}>{principle.data.title}</a>
							</li>
						))
					}
				</ul>
			</div>

			<div class="o-layout-item">
				<h2>Components</h2>
				<p>
					Read documentation on <a href="/documentation/components/"
						>using our collection of front end components</a
					>:
				</p>

				<ul>
					{
						sortedComponentDocuments.map(
							component =>
								component.frontmatter.collection_listing_display !== false && (
									<li>
										<a href={component.url}>{component.frontmatter.title}</a>
									</li>
								)
						)
					}
				</ul>
			</div>
			<div class="o-layout-item">
				<h2>Services</h2>
				<p>
					We provide <a href="/documentation/services/">several services</a> for
					use by people at the FT:
				</p>

				<ul>
					{
						allServices.map(service => (
							<li>
								<a href={`/documentation/${service.slug}`}>
									{service.data.title}
								</a>
							</li>
						))
					}
				</ul>
			</div>

			<div class="o-layout-item">
				<h2>Tutorials</h2>
				<p>
					Follow <a href="/documentation/tutorials/">our tutorials</a> for a more
					hands-on introduction to Origami.
				</p>

				<ul>
					{
						tutorialDocuments.map(
							tutorial =>
								tutorial.frontmatter.collection_listing_display !== false && (
									<li>
										<a href={tutorial.url}>{tutorial.frontmatter.title}</a>
									</li>
								)
						)
					}
				</ul>
			</div>
		</div>
	</div>
</Layout>
