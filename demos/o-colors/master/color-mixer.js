(function () {
  // demos/src/shared/contrast-ratio.js
  function getContrastRatio(foreground, background) {
    var l1 = oColorsColorLuminance(foreground) + 0.05;
    var l2 = oColorsColorLuminance(background) + 0.05;
    var ratio = l1 / l2;

    if (l2 > l1) {
      ratio = 1 / ratio;
    }

    ratio = preciseFloor(ratio);
    return ratio;
  }

  function preciseFloor(number) {
    var decimals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;
    var multiplier = Math.pow(10, decimals);
    return Math.floor(number * multiplier) / multiplier;
  }

  function oColorsColorLuminance(hex) {
    hex = hex.trim() === "gray" ? "#808080" : hex;
    var hexValue = hex.replace("#", "").trim();
    var rgbPairs = hexValue.match(/.{1,2}/g);
    var decimals = rgbPairs.map(function (pair) {
      return parseInt(pair, 16);
    });
    var colors = {
      "red": decimals[0],
      "green": decimals[1],
      "blue": decimals[2]
    };
    Object.keys(colors).forEach(function (color) {
      colors[color] = colors[color] / 255;

      if (colors[color] < 0.03928) {
        colors[color] = colors[color] / 12.92;
      } else {
        colors[color] = (colors[color] + 0.055) / 1.055;
        colors[color] = Math.pow(colors[color], 2.4);
      }
    });
    return colors["red"] * 0.2126 + colors["green"] * 0.7152 + colors["blue"] * 0.0722;
  } // demos/src/shared/colors-mix.js


  var getHexValues = function getHexValues(mixer, base) {
    var root = getComputedStyle(document.documentElement);
    return {
      mixer: root.getPropertyValue("--o-colors-".concat(mixer)).replace(/^\s*#/, ""),
      base: root.getPropertyValue("--o-colors-".concat(base)).replace(/^\s*#/, "")
    };
  };

  var expandHexValues = function expandHexValues(value) {
    if (value.length === 3 || value.length === 4) {
      return value.split("").map(function (character) {
        return character + character;
      }).join("");
    }

    return value;
  };

  var mixHexes = function mixHexes(mixer, base) {
    var fullMixer = expandHexValues(mixer);
    var fullBase = expandHexValues(base);
    var radix = 16;

    var decimalToHex = function decimalToHex(decimal) {
      return decimal.toString(radix);
    };

    var hexToDecimal = function hexToDecimal(hex) {
      return parseInt(hex, radix);
    };

    var percentages = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100];
    return percentages.map(function (percent) {
      var hexValue = "#";

      for (var i = 0; i <= 5; i += 2) {
        var mixPair = hexToDecimal(fullMixer.substr(i, 2));
        var basePair = hexToDecimal(fullBase.substr(i, 2));
        var combinedPair = decimalToHex(Math.round(basePair + (mixPair - basePair) * (percent / 100)));

        while (combinedPair.length < 2) {
          combinedPair = "0".concat(combinedPair);
        }

        hexValue += combinedPair;
      }

      return hexValue;
    });
  }; // demos/src/color-mixer/color-mixer.js


  document.addEventListener("DOMContentLoaded", function () {
    var forms = document.forms;
    var mixer = forms[0]["mixer"];
    var base = forms[0]["base"];
    forms[0].addEventListener("change", function () {
      mixColors(mixer.value, base.value);
      var hex = document.querySelector("input[type=radio]:checked");
      var percent = hex.nextElementSibling.innerText.replace("%", "");
      fillCodeSnippets(hex.value, mixer.value, base.value, percent);
    });
    mixColors(mixer.value, base.value);
    forms[1]["range"][5].checked = true;
    var defaultHex = getComputedStyle(document.documentElement).getPropertyValue("--o-colors-".concat(mixer.value, "-50"));
    fillCodeSnippets(defaultHex, mixer.value, base.value, 50);
  });

  var checkTextContrast = function checkTextContrast(background) {
    var root = document.documentElement;
    var text = getComputedStyle(root).getPropertyValue("--color");
    var textColor = text === "#000000" ? "#000000" : "#f3f3f3";
    var ratio = getContrastRatio(textColor, background);

    if (ratio <= 3) {
      textColor = textColor === "#000000" ? "#f3f3f3" : "#000000";
      root.style.setProperty("--color", textColor);
    }
  };

  var mixColors = function mixColors() {
    var mixer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "black";
    var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "paper";
    var root = document.documentElement;
    var hexes = getHexValues(mixer, base);
    root.style.setProperty("--background", "#".concat(hexes.base));
    var hexArray = mixHexes(hexes.mixer, hexes.base);
    fillSwatches(hexArray, mixer, base);
    checkTextContrast("#".concat(hexes.base));
  };

  var fillSwatches = function fillSwatches(hexes, mixer, base) {
    var range = document.forms[1]["range"];
    hexes.forEach(function (hex, index) {
      var swatch = range[index];
      swatch.style.backgroundColor = swatch.value = hex;
      swatch.addEventListener("click", function (e) {
        return fillCodeSnippets(e.target.value, mixer, base, index * 10);
      });
    });
  };

  var fillCodeSnippets = function fillCodeSnippets(hex, mixer, base, index) {
    document.getElementById("hex-value").innerText = hex.trim();
    document.getElementById("code-snippet").innerText = "oColorsMix(".concat(mixer, ", ").concat(base, ", ").concat(index, ")");
  };
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlbW9zL3NyYy9zaGFyZWQvY29udHJhc3QtcmF0aW8uanMiLCJkZW1vcy9zcmMvc2hhcmVkL2NvbG9ycy1taXguanMiLCJkZW1vcy9zcmMvY29sb3ItbWl4ZXIvY29sb3ItbWl4ZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUF5QkEsV0FBQSxnQkFBQSxDQUEwQixVQUExQixFQUFzQyxVQUF0QyxFQUFrRDtBQUNqRCxRQUFNLEVBQUEsR0FBSyxxQkFBQSxDQUFzQixVQUF0QixDQUFBLEdBQW9DLElBQS9DO0FBQ0EsUUFBTSxFQUFBLEdBQUsscUJBQUEsQ0FBc0IsVUFBdEIsQ0FBQSxHQUFvQyxJQUEvQztBQUNBLFFBQUksS0FBQSxHQUFRLEVBQUEsR0FBSyxFQUFqQjs7QUFFQSxRQUFJLEVBQUEsR0FBSyxFQUFULEVBQWE7QUFDWixNQUFBLEtBQUEsR0FBUSxJQUFJLEtBQVo7QUFBWTs7QUFHYixJQUFBLEtBQUEsR0FBUSxZQUFBLENBQWEsS0FBYixDQUFSO0FBQ0EsV0FBTyxLQUFQO0FBQU87O0FBR1IsV0FBQSxZQUFBLENBQXNCLE1BQXRCLEVBQTRDO0FBQUEsUUFBZCxRQUFjLHVFQUFILENBQUc7QUFDM0MsUUFBTSxVQUFBLEdBQWEsSUFBQSxDQUFLLEdBQUwsQ0FBUyxFQUFULEVBQWEsUUFBYixDQUFuQjtBQUNBLFdBQU8sSUFBQSxDQUFLLEtBQUwsQ0FBVyxNQUFBLEdBQVMsVUFBcEIsSUFBa0MsVUFBekM7QUFBeUM7O0FBRzFDLFdBQUEscUJBQUEsQ0FBK0IsR0FBL0IsRUFBb0M7QUFDbkMsSUFBQSxHQUFBLEdBQU0sR0FBQSxDQUFJLElBQUosT0FBZSxNQUFmLEdBQXdCLFNBQXhCLEdBQW9DLEdBQTFDO0FBQ0EsUUFBTSxRQUFBLEdBQVcsR0FBQSxDQUFJLE9BQUosQ0FBWSxHQUFaLEVBQWlCLEVBQWpCLEVBQXFCLElBQXJCLEVBQWpCO0FBQ0EsUUFBTSxRQUFBLEdBQVcsUUFBQSxDQUFTLEtBQVQsQ0FBZSxTQUFmLENBQWpCO0FB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LEtBQU4sRUFBZ0I7QUFDN0IsVUFBTSxNQUFBLEdBQVMsS0FBQSxDQUFNLEtBQU4sQ0FBZjtBQUNBLE1BQUEsTUFBQSxDQUFPLEtBQVAsQ0FBYSxlQUFiLEdBQStCLE1BQUEsQ0FBTyxLQUFQLEdBQWUsR0FBOUM7QUFFQSxNQUFBLE1BQUEsQ0FBTyxnQkFBUCxDQUF3QixPQUF4QixFQUFpQyxVQUFDLENBQUQ7QUFBQSxlQUFPLGdCQUFBLENBQWlCLENBQUEsQ0FBRSxNQUFGLENBQVMsS0FBMUIsRUFBaUMsS0FBakMsRUFBd0MsSUFBeEMsRUFBOEMsS0FBQSxHQUFRLEVBQXRELENBQVA7QUFBQSxPQUFqQztBQUE4RixLQUovRjtBQUkrRixHQU5oRzs7QUFVQSxNQUFNLGdCQUFBLEdBQW1CLFNBQW5CLGdCQUFtQixDQUFDLEdBQUQsRUFBTSxLQUFOLEVBQWEsSUFBYixFQUFtQixLQUFuQixFQUE2QjtBQUNyRCxJQUFBLFFBQUEsQ0FBUyxjQUFULENBQXdCLFdBQXhCLEVBQXFDLFNBQXJDLEdBQWlELEdBQUEsQ0FBSSxJQUFKLEVBQWpEO0FBQ0EsSUFBQSxRQUFBLENBQVMsY0FBVCxDQUF3QixjQUF4QixFQUF3QyxTQUF4Qyx3QkFBa0UsS0FBbEUsZUFBNEUsSUFBNUUsZUFBcUYsS0FBckY7QUFBcUYsR0FGdEYiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRXQ0FHUmF0aW5nKHJhdGlvLCBmb3JlZ3JvdW5kLCBiYWNrZ3JvdW5kKSB7XG5cdGxldCB3Y2FnUmF0aW5nO1xuXHRsZXQgbWVzc2FnZSA9ICdUaGlzIGNvbWJpbmF0aW9uIHBhc3NlcyBXQ0FHIGNvbG9yIGNvbnRyYXN0IGd1aWRlbGluZXMnO1xuXHRjb25zdCBjb21iaW5hdGlvbiA9IGA8Y29kZT4ke2ZvcmVncm91bmR9PC9jb2RlPiBvbiA8Y29kZT4ke2JhY2tncm91bmR9PC9jb2RlPmA7XG5cblx0aWYgKHJhdGlvID49IDcpIHtcblx0XHR3Y2FnUmF0aW5nID0gJ0FBQSc7XG5cdH0gZWxzZSBpZiAocmF0aW8gPj0gNC41KSB7XG5cdFx0d2NhZ1JhdGluZyA9ICdBQSc7XG5cdH0gZWxzZSBpZiAocmF0aW8gPj0gMykge1xuXHRcdHdjYWdSYXRpbmcgPSAnQUExOCc7XG5cdFx0bWVzc2FnZSA9IGBDYXV0aW9uOiBXaGVuIHVzaW5nIHRoaXMgY29tYmluYXRpb24sIHRleHQgc2hvdWxkIGJlIGxhcmdlciB0aGFuIDE4cHggdG8gcGFzcyBXQ0FHIGNvbG9yIGNvbnRyYXN0IGd1aWRlbGluZXMuYDtcblx0fSBlbHNlIHtcblx0XHR3Y2FnUmF0aW5nID0gJ0ZhaWwnO1xuXHRcdG1lc3NhZ2UgPSBgVGhpcyBjb21iaW5hdGlvbiBkb2VzIG5vdCBwYXNzIFdDQUcgY29sb3IgY29udHJhc3QgZ3VpZGVsaW5lcy5gO1xuXHR9XG5cblx0cmV0dXJuIHtcblx0XHRjb21iaW5hdGlvbixcblx0XHR3Y2FnUmF0aW5nLFxuXHRcdG1lc3NhZ2Vcblx0fTtcbn1cblxuXG5mdW5jdGlvbiBnZXRDb250cmFzdFJhdGlvKGZvcmVncm91bmQsIGJhY2tncm91bmQpIHtcblx0Y29uc3QgbDEgPSBvQ29sb3JzQ29sb3JMdW1pbmFuY2UoZm9yZWdyb3VuZCkgKyAwLjA1O1xuXHRjb25zdCBsMiA9IG9Db2xvcnNDb2xvckx1bWluYW5jZShiYWNrZ3JvdW5kKSArIDAuMDU7XG5cdGxldCByYXRpbyA9IGwxIC8gbDI7XG5cblx0aWYgKGwyID4gbDEpIHtcblx0XHRyYXRpbyA9IDEgLyByYXRpbztcblx0fVxuXG5cdHJhdGlvID0gcHJlY2lzZUZsb29yKHJhdGlvKTtcblx0cmV0dXJuIHJhdGlvO1xufVxuXG5mdW5jdGlvbiBwcmVjaXNlRmxvb3IobnVtYmVyLCBkZWNpbWFscyA9IDIpIHtcblx0Y29uc3QgbXVsdGlwbGllciA9IE1hdGgucG93KDEwLCBkZWNpbWFscyk7XG5cdHJldHVybiBNYXRoLmZsb29yKG51bWJlciAqIG11bHRpcGxpZXIpIC8gbXVsdGlwbGllcjtcbn1cblxuZnVuY3Rpb24gb0NvbG9yc0NvbG9yTHVtaW5hbmNlKGhleCkge1xuXHRoZXggPSBoZXgudHJpbSgpID09PSAnZ3JheScgPyAnIzgwODA4MCcgOiBoZXg7IC8vIGFuIGVxdWFsIG1peCBvZiBibGFjayBhbmQgd2hpdGUgd2lsbCBhbHdheXMgZGVmYXVsdCB0byAnZ3JheScgaW5zdGVhZCBvZiBhIGhleCB2YWx1ZVxuXHRjb25zdCBoZXhWYWx1ZSA9IGhleC5yZXBsYWNlKCcjJywgJycpLnRyaW0oKTtcblx0Y29uc3QgcmdiUGFpcnMgPSBoZXhWYWx1ZS5tYXRjaCgvLnsxLDJ9L2cpO1xuXG5cdGNvbnN0IGRlY2ltYWxzID0gcmdiUGFpcnMubWFwKHBhaXIgPT4ge1xuXHRcdHJldHVybiBwYXJzZUludChwYWlyLCAxNik7XG5cdH0pO1xuXG5cdGNvbnN0IGNvbG9ycyA9IHtcblx0XHQncmVkJzogZGVjaW1hbHNbMF0sXG5cdFx0J2dyZWVuJzogZGVjaW1hbHNbMV0sXG5cdFx0J2JsdWUnOiBkZWNpbWFsc1syXVxuXHR9O1xuXG5cdE9iamVjdC5rZXlzKGNvbG9ycykuZm9yRWFjaChjb2xvciA9PiB7XG5cdFx0Y29sb3JzW2NvbG9yXSA9IGNvbG9yc1tjb2xvcl0gLyAyNTU7XG5cblx0XHRpZiAoY29sb3JzW2NvbG9yXSA8IDAuMDM5MjgpIHtcblx0XHRcdGNvbG9yc1tjb2xvcl0gPSBjb2xvcnNbY29sb3JdIC8gMTIuOTI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbG9yc1tjb2xvcl0gPSAoY29sb3JzW2NvbG9yXSArIDAuMDU1KSAvIDEuMDU1O1xuXHRcdFx0Y29sb3JzW2NvbG9yXSA9IE1hdGgucG93KGNvbG9yc1tjb2xvcl0sIDIuNCk7XG5cdFx0fVxuXG5cdH0pO1xuXHRyZXR1cm4gY29sb3JzWydyZWQnXSAqIDAuMjEyNiArIGNvbG9yc1snZ3JlZW4nXSAqIDAuNzE1MiArIGNvbG9yc1snYmx1ZSddICogMC4wNzIyO1xufVxuXG5leHBvcnQge1xuXHRnZXRXQ0FHUmF0aW5nLFxuXHRnZXRDb250cmFzdFJhdGlvXG59O1xuIiwiY29uc3QgZ2V0SGV4VmFsdWVzID0gKG1peGVyLCBiYXNlKSA9PiB7XG5cdGNvbnN0IHJvb3QgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG5cdHJldHVybiB7XG5cdFx0bWl4ZXI6IHJvb3QuZ2V0UHJvcGVydHlWYWx1ZShgLS1vLWNvbG9ycy0ke21peGVyfWApLnJlcGxhY2UoL15cXHMqIy8sICcnKSxcblx0XHRiYXNlOiByb290LmdldFByb3BlcnR5VmFsdWUoYC0tby1jb2xvcnMtJHtiYXNlfWApLnJlcGxhY2UoL15cXHMqIy8sICcnKVxuXHR9O1xufTtcblxuY29uc3QgZXhwYW5kSGV4VmFsdWVzID0gKHZhbHVlKSA9PiB7XG5cdC8vIFRoZSB0aHJlZS1kaWdpdCBub3RhdGlvbiAoI1JHQikgaXMgYSBzaG9ydGVyIHZlcnNpb24gb2YgdGhlIHNpeC1kaWdpdCBmb3JtICgjUlJHR0JCKS5cblx0Ly8gRm9yIGV4YW1wbGUsICNmMDkgaXMgdGhlIHNhbWUgY29sb3IgYXMgI2ZmMDA5OS5cblx0Ly8gTGlrZXdpc2UsIHRoZSBmb3VyLWRpZ2l0IFJHQiBub3RhdGlvbiAoI1JHQkEpIGlzIGEgc2hvcnRlciB2ZXJzaW9uIG9mIHRoZSBlaWdodC1kaWdpdCBmb3JtICgjUlJHR0JCQUEpLlxuXHRpZiAodmFsdWUubGVuZ3RoID09PSAzIHx8IHZhbHVlLmxlbmd0aCA9PT0gNCkge1xuXHRcdHJldHVybiB2YWx1ZS5zcGxpdCgnJykubWFwKGNoYXJhY3RlciA9PiB7XG5cdFx0XHRyZXR1cm4gY2hhcmFjdGVyICsgY2hhcmFjdGVyO1xuXHRcdH0pLmpvaW4oJycpO1xuXHR9XG5cdHJldHVybiB2YWx1ZTtcbn07XG5cbmNvbnN0IG1peEhleGVzID0gKG1peGVyLCBiYXNlKSA9PiB7XG5cdGNvbnN0IGZ1bGxNaXhlciA9IGV4cGFuZEhleFZhbHVlcyhtaXhlcik7XG5cdGNvbnN0IGZ1bGxCYXNlID0gZXhwYW5kSGV4VmFsdWVzKGJhc2UpO1xuXHRjb25zdCByYWRpeCA9IDE2O1xuXHRjb25zdCBkZWNpbWFsVG9IZXggPSBkZWNpbWFsID0+IGRlY2ltYWwudG9TdHJpbmcocmFkaXgpO1xuXHRjb25zdCBoZXhUb0RlY2ltYWwgPSBoZXggPT4gcGFyc2VJbnQoaGV4LCByYWRpeCk7XG5cblx0Y29uc3QgcGVyY2VudGFnZXMgPSBbMCwgMTAsIDIwLCAzMCwgNDAsIDUwLCA2MCwgNzAsIDgwLCA5MCwgMTAwXTtcblxuXHRyZXR1cm4gcGVyY2VudGFnZXMubWFwKHBlcmNlbnQgPT4ge1xuXG5cdFx0bGV0IGhleFZhbHVlID0gXCIjXCI7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8PSA1OyBpICs9IDIpIHtcblx0XHRcdGNvbnN0IG1peFBhaXIgPSBoZXhUb0RlY2ltYWwoZnVsbE1peGVyLnN1YnN0cihpLCAyKSk7IC8vIGV4dHJhY3QgciwgZywgYiBwYWlycyBmb3IgbWl4ZXIgY29sb3Jcblx0XHRcdGNvbnN0IGJhc2VQYWlyID0gaGV4VG9EZWNpbWFsKGZ1bGxCYXNlLnN1YnN0cihpLCAyKSk7IC8vIGV4dHJhY3QgciwgZywgYiBwYWlycyBmb3IgYmFzZSBjb2xvclxuXG5cdFx0XHQvLyBjb21iaW5lIHRoZSByL2cvYiBwYWlycyBmcm9tIGVhY2ggY29sb3IsIGJhc2VkIG9uIHBlcmNlbnRhZ2Vcblx0XHRcdGxldCBjb21iaW5lZFBhaXIgPSBkZWNpbWFsVG9IZXgoTWF0aC5yb3VuZChiYXNlUGFpciArIChtaXhQYWlyIC0gYmFzZVBhaXIpICogKHBlcmNlbnQgLyAxMDAuMCkpKTtcblxuXHRcdFx0d2hpbGUgKGNvbWJpbmVkUGFpci5sZW5ndGggPCAyKSB7IGNvbWJpbmVkUGFpciA9IGAwJHtjb21iaW5lZFBhaXJ9YDsgfS8vIHByZXBlbmQgYSAnMCcgaWYgY29tYmluZWRQYWlyIHJlc3VsdHMgaW4gYSBzaW5nbGUgZGlnaXRcblxuXHRcdFx0aGV4VmFsdWUgKz0gY29tYmluZWRQYWlyOyAvL2FkZCBuZXcgcGFpciB0byBoZXggc3RyaW5nXG5cdFx0fVxuXG5cdFx0cmV0dXJuIGhleFZhbHVlO1xuXHR9KTtcbn07XG5cbmV4cG9ydCB7XG5cdGdldEhleFZhbHVlcyxcblx0bWl4SGV4ZXMsXG5cdGV4cGFuZEhleFZhbHVlc1xufTtcbiIsImltcG9ydCB7IGdldENvbnRyYXN0UmF0aW8gfSBmcm9tICcuLi9zaGFyZWQvY29udHJhc3QtcmF0aW8uanMnO1xuaW1wb3J0IHsgZ2V0SGV4VmFsdWVzLCBtaXhIZXhlcyB9IGZyb20gJy4uL3NoYXJlZC9jb2xvcnMtbWl4LmpzJztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuXHRjb25zdCBmb3JtcyA9IGRvY3VtZW50LmZvcm1zO1xuXHRjb25zdCBtaXhlciA9IGZvcm1zWzBdWydtaXhlciddO1xuXHRjb25zdCBiYXNlID0gZm9ybXNbMF1bJ2Jhc2UnXTtcblxuXHRmb3Jtc1swXS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG5cdFx0bWl4Q29sb3JzKG1peGVyLnZhbHVlLCBiYXNlLnZhbHVlKTtcblxuXHRcdGNvbnN0IGhleCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9cmFkaW9dOmNoZWNrZWQnKTtcblx0XHRjb25zdCBwZXJjZW50ID0gaGV4Lm5leHRFbGVtZW50U2libGluZy5pbm5lclRleHQucmVwbGFjZSgnJScsICcnKTtcblx0XHRmaWxsQ29kZVNuaXBwZXRzKGhleC52YWx1ZSwgbWl4ZXIudmFsdWUsIGJhc2UudmFsdWUsIHBlcmNlbnQpO1xuXHR9KTtcblxuXHRtaXhDb2xvcnMobWl4ZXIudmFsdWUsIGJhc2UudmFsdWUpO1xuXG5cdC8vc2V0IHZpc2libGUgaGV4IHZhbHVlIGFuZCBzYXNzIGZ1bmN0aW9uIHRvIGRlZmF1bHQgdmFsdWVzIG9mIG1peENvbG9yc1xuXHRmb3Jtc1sxXVsncmFuZ2UnXVs1XS5jaGVja2VkID0gdHJ1ZTtcblx0Y29uc3QgZGVmYXVsdEhleCA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKGAtLW8tY29sb3JzLSR7bWl4ZXIudmFsdWV9LTUwYCk7XG5cdGZpbGxDb2RlU25pcHBldHMoZGVmYXVsdEhleCwgbWl4ZXIudmFsdWUsIGJhc2UudmFsdWUsIDUwKTtcbn0pO1xuXG5jb25zdCBjaGVja1RleHRDb250cmFzdCA9IChiYWNrZ3JvdW5kKSA9PiB7XG5cdGNvbnN0IHJvb3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cdGNvbnN0IHRleHQgPSBnZXRDb21wdXRlZFN0eWxlKHJvb3QpLmdldFByb3BlcnR5VmFsdWUoJy0tY29sb3InKTtcblxuXHRsZXQgdGV4dENvbG9yID0gdGV4dCA9PT0gJyMwMDAwMDAnID8gJyMwMDAwMDAnIDogJyNmM2YzZjMnO1xuXHRjb25zdCByYXRpbyA9IGdldENvbnRyYXN0UmF0aW8odGV4dENvbG9yLCBiYWNrZ3JvdW5kKTtcblxuXHRpZiAocmF0aW8gPD0gMykgeyAvLyBpZiBpdCBmYWlscyBhY2Nlc3NiaWxpdHksIGNoYW5nZSB0ZXh0IGNvbG91clxuXHRcdHRleHRDb2xvciA9IHRleHRDb2xvciA9PT0gJyMwMDAwMDAnID8gJyNmM2YzZjMnIDogJyMwMDAwMDAnO1xuXHRcdHJvb3Quc3R5bGUuc2V0UHJvcGVydHkoJy0tY29sb3InLCB0ZXh0Q29sb3IpO1xuXHR9XG59O1xuXG5jb25zdCBtaXhDb2xvcnMgPSAobWl4ZXIgPSAnYmxhY2snLCBiYXNlID0gJ3BhcGVyJykgPT4ge1xuXHRjb25zdCByb290ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXHRjb25zdCBoZXhlcyA9IGdldEhleFZhbHVlcyhtaXhlciwgYmFzZSk7XG5cdHJvb3Quc3R5bGUuc2V0UHJvcGVydHkoJy0tYmFja2dyb3VuZCcsIGAjJHtoZXhlcy5iYXNlfWApO1xuXG5cdGNvbnN0IGhleEFycmF5ID0gbWl4SGV4ZXMoaGV4ZXMubWl4ZXIsIGhleGVzLmJhc2UpO1xuXHRmaWxsU3dhdGNoZXMoaGV4QXJyYXksIG1peGVyLCBiYXNlKTtcblx0Y2hlY2tUZXh0Q29udHJhc3QoYCMke2hleGVzLmJhc2V9YCk7XG59O1xuXG5jb25zdCBmaWxsU3dhdGNoZXMgPSAoaGV4ZXMsIG1peGVyLCBiYXNlKSA9PiB7XG5cdGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuZm9ybXNbMV1bJ3JhbmdlJ107XG5cdGhleGVzLmZvckVhY2goKGhleCwgaW5kZXgpID0+IHtcblx0XHRjb25zdCBzd2F0Y2ggPSByYW5nZVtpbmRleF07XG5cdFx0c3dhdGNoLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHN3YXRjaC52YWx1ZSA9IGhleDtcblxuXHRcdHN3YXRjaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiBmaWxsQ29kZVNuaXBwZXRzKGUudGFyZ2V0LnZhbHVlLCBtaXhlciwgYmFzZSwgaW5kZXggKiAxMCkpO1xuXHR9KTtcbn07XG5cbmNvbnN0IGZpbGxDb2RlU25pcHBldHMgPSAoaGV4LCBtaXhlciwgYmFzZSwgaW5kZXgpID0+IHtcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hleC12YWx1ZScpLmlubmVyVGV4dCA9IGhleC50cmltKCk7XG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb2RlLXNuaXBwZXQnKS5pbm5lclRleHQgPSBgb0NvbG9yc01peCgke21peGVyfSwgJHtiYXNlfSwgJHtpbmRleH0pYDtcbn07XG4iXX0=