/// @access private
@mixin _oTopperThemeElements($themes) {
	@if index($themes, 'opinion') {
		.o-topper__opinion-genre {
			@include _oTopperOpinionGenre;
		}
	}

	.o-topper__headshot {
		@include _oTopperHeadshot;
	}

	.o-topper__headshot-image {
		@include _oTopperHeadshotImage;
	}

	.o-topper__anchor-link {
		@include _oTopperAnchorLink;
	}
}

/// @access private
@mixin _oTopperThemes($themes) {
	@include _oTopperThemeElements($themes);

	@if index($themes, 'basic') {
		.o-topper--basic {
			@include _oTopperBasic;
			@if index($themes, 'right-rail') {
				&.o-topper--right-rail {
					@include _oTopperGridRightRail;
				}
			}
		}
	}

	@if index($themes, 'branded') {
		.o-topper--branded {
			@include _oTopperThemeBranded;
			@if index($themes, 'right-rail') {
				&.o-topper--right-rail {
					@include _oTopperGridRightRail;
				}
			}
		}
	}

	@if index($themes, 'opinion') {
		.o-topper--opinion {
			@include _oTopperThemeOpinion;
			@if index($themes, 'right-rail') {
				&.o-topper--right-rail {
					@include _oTopperGridRightRail;
				}
			}
		}
	}

	@if index($themes, 'has-headshot') {
		.o-topper--has-headshot {
			@include _oTopperHasHeadshot;
		}
	}

	@if index($themes, 'full-bleed-offset') {
		.o-topper--full-bleed-offset {
			$right-rail: index($themes, 'right-rail');
			@include _oTopperThemeFullBleedOffset($right-rail);
		}
	}

	@if index($themes, 'split-text-left') or index($themes, 'split-text-center') {
		.o-topper--split-text-left,
		.o-topper--split-text-center {
			@include _oTopperThemeSplitText;
		}
	}

	// @deprecated full-bleed-image-center is deprecated
	// https://github.com/Financial-Times/o-topper/issues/75
	@if index($themes, 'full-bleed-image-center') or index($themes, 'full-bleed-image-left') {
		.o-topper--full-bleed-image-center,
		.o-topper--full-bleed-image-left {
			@include _oTopperThemeFullBleedImage;
		}
	}

	@if index($themes, 'full-bleed-image-center') {
		.o-topper--full-bleed-image-center {
			@include oGridRespondTo(S) {
				@include _oTopperAlignText(center);
			}
		}
	}

	// The package theme is used for toppers of an article package/series,
	// not as a topper for a single article. It can be used in conjunction with
	// other package modifier classes for different kinds of article packages.
	@if index($themes, 'package') {
		.o-topper--package {
			@include _oTopperThemePackage;
		}
	}

	// Used in conjunction with the `o-topper--package` modifier,
	// `o-topper--package-extra` modifies the package/article series topper so
	// editorial can differentiate series.
	//
	// `o-topper--package-extra-wide` is deprecated. Authors can no longer
	// select `extra-wide` as an option for new packages in the Spark CMS.
	// @link https://github.com/Financial-Times/next-es-interface/blob/10ef5314b6e0156f6f0052ebd5c47a6eb4eb8688/server/models/article/design.js#L7 Related ft.com implementation code.
	// @link https://github.com/Financial-Times/n-map-content-to-topper/blob/e482969abd03aa98924650c4252fe47bfbe50b93/src/lib/get-topper-settings.js#L101 Related ft.com implementation code.
	// @link https://www.ft.com/europopulists An example package-extra usecase.
	// @deprecated package-extra-wide is deprecated, use package-extra instead.
	@if index($themes, 'package-extra') or index($themes, 'package-extra-wide') {
		.o-topper--package-extra,
		.o-topper--package-extra-wide {
			@include _oTopperThemePackageExtra;
		}
	}

	// Used in conjunction with the `o-topper--package` modifier,
	// `o-topper--package-special-report` modifies the package/article series
	// topper so editorial can differentiate a special report series.
	//
	// @link https://www.ft.com/reports/corporate-change-and-technology An example package-special-report usecase.
	@if index($themes, 'package-special-report') {
		.o-topper--package-special-report {
			@include _oTopperThemePackageSpecialReport;
		}
	}

	@if index($themes, 'news-package') {
		.o-topper--news-package {
			@include _oTopperThemeNewsPackage;
		}
	}

	@if index($themes, 'centered') {
		.o-topper--centered {
			@include _oTopperCentered;
		}
	}
}

/// @access private
@mixin _oTopperElements($elements) {
	@if index($elements, 'content') {
		.o-topper__content {
			@include _oTopperContent;
		}
	}

	@if index($elements, 'visual') {
		.o-topper__visual {
			@include _oTopperVisual;
		}
	}

	@if index($elements, 'visual') or index($elements, 'background') {
		.o-topper__visual,
		.o-topper__background {
			@include _oTopperBackground;
		}
	}

	@if index($elements, 'headline') {
		.o-topper__headline {
			@include oEditorialTypographyHeading($level: 1);
			margin-bottom: oSpacingByIncrement(5);
		}

		.o-topper__headline--large {
			@include oEditorialTypographyHeadline();
			position: relative; //so it appears above the full width background
			margin-bottom: oSpacingByIncrement(7);
		}
	}

	@if index($elements, 'summary') {
		.o-topper__summary {
			@include _oTopperSummary;
		}
	}

	@if index($elements, 'standfirst') {
		.o-topper__standfirst {
			@include _oTopperStandfirst;
		}
	}

	@if index($elements, 'summary--body') {
		.o-topper__summary--body {
			@include _oTopperSummaryBody;
		}
	}

	@if index($elements, 'tags') {
		.o-topper__tags {
			@include _oTopperTags;
		}
	}

	@if index($elements, 'columnist') {
		.o-topper__columnist {
			@include _oTopperColumnist;
		}
	}

	@if index($elements, 'columnist-name') {
		.o-topper__columnist-name {
			@include _oTopperColumnistName;
		}
	}

	@if index($elements, 'brand') {
		.o-topper__brand {
			@include _oTopperBrand;
		}
	}

	@if index($elements, 'topic') {
		.o-topper__topic {
			@include _oTopperTopic;
		}
	}

	@if index($elements, 'read-next') {
		.o-topper__read-next {
			@include _oTopperReadNext;
		}
	}

	@if index($elements, 'image') {
		.o-topper__image {
			@include _oTopperImage;
		}
	}

	@if index($elements, 'image-credit') {
		.o-topper__image-credit {
			@include _oTopperImageCredit;
		}
	}
}

/// @access private
@mixin _oTopperColors($colors) {
	@each $color in $colors {
		.o-topper--color-#{$color} {
			@include _oTopperColor($color);
		}
	}
}

// uses topper background colour to set background and pick contrasting text color
/// @access private
@mixin _oTopperColor($color-name) {
	$background: oColorsByName($color-name);
	$foreground: oColorsGetTextColor($background, $opacity: 100);
	$link-text-color: oColorsByUsecase('link', 'text');
	$link-contrasts-with-background: oColorsGetContrastRatio($background, $link-text-color) > 4.5;

	// include oTopperColor on a parent then extend this placeholder on a
	// descendent to lend that descendent the color you specified in the mixin
	.o-topper__background,
	.o-topper__content {
		background-color: $background;
	}


	.o-topper__standfirst,
	.o-topper__summary {
		@if $link-contrasts-with-background {
			a {
				@include oTypographyLink();
			}
		} @else {
			a {
				$hover-color: darken($foreground, 20%);
				color: $foreground;
				border-bottom-color: $foreground;
				text-decoration-color: $foreground;

				&:hover {
					color: $hover-color;
					border-bottom-color: $hover-color;
					text-decoration-color: $hover-color;
				}
			}
		}
	}

	.o-topper__headline {
		&::after {
			border-bottom: 6px solid $foreground;
			@include oGridRespondTo($from: L) {
				border-bottom-width: 8px;
			}
		}
	}

	.o-topper__tags,
	.o-topper__columnist-name,
	.o-topper__headline,
	.o-topper__standfirst,
	.o-topper__summary {
		color: $foreground;
	}

	.o-topper__topic,
	.o-topper__brand {
		color: $foreground;

		&:hover {
			color: oColorsMix($foreground, $color-name, 73);
		}
	}

	@if $color-name == 'paper' or $color-name == 'wheat' {
		.o-topper__opinion-genre,
		.o-topper__topic,
		.o-topper__columnist-name {
			color: oColorsByUsecase('tag-link', 'text');

			&:hover {
				color: oColorsByUsecase('tag-link-hover', 'text');
			}
		}
	}

	@if $color-name == 'sky' {
		.o-topper__tags,
		.o-topper__topic,
		.o-topper__columnist-name {
			color: oColorsByName('oxford');

			&:hover {
				color: oColorsByName('black-80');
			}
		}
	}
}

/// @access private
@mixin _oTopperAlignText($position) {
	$mleft: ('left': 0, 'center': auto, 'right': auto);
	$mright: ('left': auto, 'center': auto, 'right': 0);
	$value: ('left': flex-start, 'center': center, 'right': flex-end);

	.o-topper__headline--large {
		&:after {
			margin-left: map-get($mleft, #{$position});
			margin-right: map-get($mright, #{$position});
		}
	}

	.o-topper__content {
		text-align: $position;
		align-self: map-get($value, #{$position});
	}

	.o-topper__tags {
		justify-content: map-get($value, #{$position});
	}
}
